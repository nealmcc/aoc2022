package main

import (
	"fmt"
	"time"
)

func main() {
	// file, err := os.Open("input.txt")
	// if err != nil {
	// 	log.Fatal(err)
	// }
	// defer file.Close()

	crates := []crate{
		[]byte{}, // the input is 1-based
		[]byte("WRF"),
		[]byte("THMCDVWP"),
		[]byte("PMZNL"),
		[]byte("JCHR"),
		[]byte("CPGHQTB"),
		[]byte("GCWLFZ"),
		[]byte("WVLQZJGC"),
		[]byte("PNRFWTVC"),
		[]byte("JWHGRSV"),
	}

	start := time.Now()
	// p1 := part1(crates)
	p2 := part2(crates)

	middle := time.Now()

	// p2, err := part2(file)
	// if err != nil {
	// 	log.Fatalf("part2: %s", err)
	// }
	// end := time.Now()

	fmt.Printf("part 2: %s in %s\n", p2, middle.Sub(start))
	// fmt.Printf("part 2: %d in %s\n", p2, end.Sub(middle))
}

type crate []byte

// part1 moves crates usint the rules from part 1.
func part2(crates []crate) []byte {
	move(crates, 2, 4, 9)
	move(crates, 5, 2, 9)
	move(crates, 1, 5, 1)
	move(crates, 3, 1, 4)
	move(crates, 2, 4, 6)
	move(crates, 7, 6, 9)
	move(crates, 5, 3, 9)
	move(crates, 1, 8, 6)
	move(crates, 3, 2, 3)
	move(crates, 12, 9, 3)
	move(crates, 4, 9, 7)
	move(crates, 15, 3, 9)
	move(crates, 1, 1, 5)
	move(crates, 2, 6, 5)
	move(crates, 18, 9, 1)
	move(crates, 6, 8, 1)
	move(crates, 1, 8, 7)
	move(crates, 5, 7, 2)
	move(crates, 6, 1, 2)
	move(crates, 7, 9, 6)
	move(crates, 6, 1, 3)
	move(crates, 5, 3, 9)
	move(crates, 3, 9, 1)
	move(crates, 1, 7, 9)
	move(crates, 4, 2, 1)
	move(crates, 5, 6, 3)
	move(crates, 1, 3, 4)
	move(crates, 1, 5, 9)
	move(crates, 2, 9, 6)
	move(crates, 5, 5, 9)
	move(crates, 10, 1, 8)
	move(crates, 4, 3, 8)
	move(crates, 3, 4, 9)
	move(crates, 4, 6, 9)
	move(crates, 14, 8, 6)
	move(crates, 1, 3, 8)
	move(crates, 14, 9, 4)
	move(crates, 6, 1, 6)
	move(crates, 1, 8, 2)
	move(crates, 3, 5, 8)
	move(crates, 1, 8, 9)
	move(crates, 1, 8, 1)
	move(crates, 5, 4, 9)
	move(crates, 1, 8, 4)
	move(crates, 3, 9, 4)
	move(crates, 3, 7, 5)
	move(crates, 7, 6, 3)
	move(crates, 7, 4, 1)
	move(crates, 3, 9, 1)
	move(crates, 7, 2, 3)
	move(crates, 1, 4, 8)
	move(crates, 8, 6, 2)
	move(crates, 2, 7, 4)
	move(crates, 1, 7, 4)
	move(crates, 1, 7, 9)
	move(crates, 1, 5, 9)
	move(crates, 1, 9, 4)
	move(crates, 1, 4, 2)
	move(crates, 8, 4, 9)
	move(crates, 1, 4, 2)
	move(crates, 5, 9, 4)
	move(crates, 2, 6, 9)
	move(crates, 1, 6, 9)
	move(crates, 1, 8, 1)
	move(crates, 13, 3, 2)
	move(crates, 1, 3, 9)
	move(crates, 2, 6, 8)
	move(crates, 1, 8, 1)
	move(crates, 14, 1, 7)
	move(crates, 4, 2, 1)
	move(crates, 2, 9, 5)
	move(crates, 3, 9, 7)
	move(crates, 1, 8, 2)
	move(crates, 4, 1, 5)
	move(crates, 1, 4, 7)
	move(crates, 3, 9, 1)
	move(crates, 7, 7, 4)
	move(crates, 14, 2, 8)
	move(crates, 3, 1, 7)
	move(crates, 3, 5, 4)
	move(crates, 2, 1, 9)
	move(crates, 11, 8, 9)
	move(crates, 3, 7, 8)
	move(crates, 3, 8, 6)
	move(crates, 6, 4, 3)
	move(crates, 2, 6, 8)
	move(crates, 8, 4, 3)
	move(crates, 3, 8, 7)
	move(crates, 2, 8, 2)
	move(crates, 2, 3, 9)
	move(crates, 1, 6, 8)
	move(crates, 5, 2, 7)
	move(crates, 10, 9, 7)
	move(crates, 1, 8, 5)
	move(crates, 3, 5, 2)
	move(crates, 6, 7, 5)
	move(crates, 19, 7, 3)
	move(crates, 9, 5, 9)
	move(crates, 6, 2, 6)
	move(crates, 2, 7, 3)
	move(crates, 29, 3, 8)
	move(crates, 2, 7, 9)
	move(crates, 5, 8, 1)
	move(crates, 12, 9, 6)
	move(crates, 1, 3, 8)
	move(crates, 1, 2, 7)
	move(crates, 1, 3, 1)
	move(crates, 10, 6, 1)
	move(crates, 1, 6, 7)
	move(crates, 9, 1, 9)
	move(crates, 2, 1, 2)
	move(crates, 12, 9, 4)
	move(crates, 7, 6, 3)
	move(crates, 8, 3, 7)
	move(crates, 5, 7, 6)
	move(crates, 19, 8, 3)
	move(crates, 10, 4, 6)
	move(crates, 1, 4, 6)
	move(crates, 6, 8, 6)
	move(crates, 1, 4, 2)
	move(crates, 6, 6, 3)
	move(crates, 3, 2, 7)
	move(crates, 13, 6, 3)
	move(crates, 1, 9, 1)
	move(crates, 6, 1, 8)
	move(crates, 1, 6, 5)
	move(crates, 1, 5, 4)
	move(crates, 3, 7, 1)
	move(crates, 2, 1, 3)
	move(crates, 11, 3, 8)
	move(crates, 1, 4, 3)
	move(crates, 3, 8, 4)
	move(crates, 1, 7, 5)
	move(crates, 3, 8, 9)
	move(crates, 2, 9, 2)
	move(crates, 7, 8, 3)
	move(crates, 1, 7, 9)
	move(crates, 1, 1, 4)
	move(crates, 32, 3, 4)
	move(crates, 1, 5, 9)
	move(crates, 2, 8, 3)
	move(crates, 2, 6, 4)
	move(crates, 1, 9, 4)
	move(crates, 1, 9, 2)
	move(crates, 3, 3, 1)
	move(crates, 1, 8, 6)
	move(crates, 1, 6, 2)
	move(crates, 1, 9, 3)
	move(crates, 1, 1, 7)
	move(crates, 1, 8, 7)
	move(crates, 2, 3, 8)
	move(crates, 1, 8, 4)
	move(crates, 1, 1, 2)
	move(crates, 2, 4, 8)
	move(crates, 1, 1, 8)
	move(crates, 26, 4, 6)
	move(crates, 3, 8, 5)
	move(crates, 3, 7, 6)
	move(crates, 7, 6, 3)
	move(crates, 18, 6, 8)
	move(crates, 16, 8, 9)
	move(crates, 1, 5, 1)
	move(crates, 2, 8, 3)
	move(crates, 3, 9, 8)
	move(crates, 3, 6, 4)
	move(crates, 2, 5, 4)
	move(crates, 1, 6, 4)
	move(crates, 2, 7, 2)
	move(crates, 2, 3, 9)
	move(crates, 4, 8, 3)
	move(crates, 1, 1, 2)
	move(crates, 6, 9, 7)
	move(crates, 2, 2, 5)
	move(crates, 12, 3, 1)
	move(crates, 9, 9, 2)
	move(crates, 10, 1, 3)
	move(crates, 2, 5, 9)
	move(crates, 8, 4, 7)
	move(crates, 13, 7, 6)
	move(crates, 6, 6, 5)
	move(crates, 4, 5, 3)
	move(crates, 2, 5, 4)
	move(crates, 8, 4, 3)
	move(crates, 1, 7, 2)
	move(crates, 15, 2, 7)
	move(crates, 8, 3, 7)
	move(crates, 1, 1, 6)
	move(crates, 7, 7, 1)
	move(crates, 5, 1, 6)
	move(crates, 7, 3, 2)
	move(crates, 3, 1, 6)
	move(crates, 12, 7, 9)
	move(crates, 12, 9, 8)
	move(crates, 1, 7, 1)
	move(crates, 2, 9, 5)
	move(crates, 1, 1, 9)
	move(crates, 4, 4, 2)
	move(crates, 4, 8, 4)
	move(crates, 2, 7, 2)
	move(crates, 4, 6, 5)
	move(crates, 4, 8, 9)
	move(crates, 1, 8, 4)
	move(crates, 5, 5, 3)
	move(crates, 5, 2, 4)
	move(crates, 5, 9, 5)
	move(crates, 1, 3, 6)
	move(crates, 1, 7, 8)
	move(crates, 12, 3, 9)
	move(crates, 4, 2, 6)
	move(crates, 7, 4, 9)
	move(crates, 13, 6, 4)
	move(crates, 3, 6, 9)
	move(crates, 4, 4, 2)
	move(crates, 1, 3, 4)
	move(crates, 21, 9, 7)
	move(crates, 4, 2, 1)
	move(crates, 3, 5, 4)
	move(crates, 8, 7, 6)
	move(crates, 2, 7, 2)
	move(crates, 11, 4, 2)
	move(crates, 1, 9, 7)
	move(crates, 1, 5, 7)
	move(crates, 1, 1, 8)
	move(crates, 5, 2, 5)
	move(crates, 1, 3, 5)
	move(crates, 2, 4, 9)
	move(crates, 3, 4, 8)
	move(crates, 3, 1, 8)
	move(crates, 1, 9, 6)
	move(crates, 8, 7, 8)
	move(crates, 9, 6, 5)
	move(crates, 1, 9, 6)
	move(crates, 1, 6, 4)
	move(crates, 3, 7, 5)
	move(crates, 1, 6, 9)
	move(crates, 12, 5, 1)
	move(crates, 2, 5, 8)
	move(crates, 1, 9, 6)
	move(crates, 2, 7, 6)
	move(crates, 9, 1, 8)
	move(crates, 1, 6, 9)
	move(crates, 1, 9, 2)
	move(crates, 1, 4, 2)
	move(crates, 2, 6, 7)
	move(crates, 5, 8, 3)
	move(crates, 2, 7, 4)
	move(crates, 16, 8, 5)
	move(crates, 2, 3, 8)
	move(crates, 7, 5, 1)
	move(crates, 3, 3, 8)
	move(crates, 7, 5, 7)
	move(crates, 4, 5, 2)
	move(crates, 6, 7, 9)
	move(crates, 2, 9, 6)
	move(crates, 2, 9, 2)
	move(crates, 1, 6, 8)
	move(crates, 12, 2, 6)
	move(crates, 2, 9, 6)
	move(crates, 1, 5, 2)
	move(crates, 3, 5, 4)
	move(crates, 9, 2, 6)
	move(crates, 6, 8, 3)
	move(crates, 1, 7, 5)
	move(crates, 1, 6, 7)
	move(crates, 1, 7, 8)
	move(crates, 1, 5, 8)
	move(crates, 5, 1, 2)
	move(crates, 3, 4, 5)
	move(crates, 4, 6, 8)
	move(crates, 5, 2, 9)
	move(crates, 5, 8, 4)
	move(crates, 1, 1, 4)
	move(crates, 9, 8, 4)
	move(crates, 1, 2, 3)
	move(crates, 3, 6, 8)
	move(crates, 4, 9, 2)
	move(crates, 2, 6, 4)
	move(crates, 2, 3, 1)
	move(crates, 4, 4, 7)
	move(crates, 6, 4, 5)
	move(crates, 10, 6, 8)
	move(crates, 4, 1, 9)
	move(crates, 4, 7, 5)
	move(crates, 3, 3, 9)
	move(crates, 6, 9, 8)
	move(crates, 2, 2, 9)
	move(crates, 8, 4, 3)
	move(crates, 2, 2, 7)
	move(crates, 1, 4, 9)
	move(crates, 6, 3, 8)
	move(crates, 2, 7, 8)
	move(crates, 6, 5, 9)
	move(crates, 5, 5, 6)
	move(crates, 2, 5, 9)
	move(crates, 7, 9, 5)
	move(crates, 2, 1, 9)
	move(crates, 6, 5, 8)
	move(crates, 1, 5, 1)
	move(crates, 2, 3, 6)
	move(crates, 1, 3, 6)
	move(crates, 4, 9, 5)
	move(crates, 1, 3, 4)
	move(crates, 1, 1, 2)
	move(crates, 1, 2, 1)
	move(crates, 1, 6, 8)
	move(crates, 14, 8, 5)
	move(crates, 6, 5, 1)
	move(crates, 16, 8, 3)
	move(crates, 2, 8, 2)
	move(crates, 10, 6, 7)
	move(crates, 1, 6, 9)
	move(crates, 2, 2, 9)
	move(crates, 2, 7, 3)
	move(crates, 1, 8, 5)
	move(crates, 3, 9, 1)
	move(crates, 4, 9, 5)
	move(crates, 9, 3, 8)
	move(crates, 2, 3, 6)
	move(crates, 5, 3, 8)
	move(crates, 1, 4, 2)
	move(crates, 12, 8, 4)
	move(crates, 1, 8, 9)
	move(crates, 4, 5, 9)
	move(crates, 7, 7, 1)
	move(crates, 10, 5, 2)
	move(crates, 2, 5, 2)
	move(crates, 1, 6, 5)
	move(crates, 2, 5, 2)
	move(crates, 5, 2, 6)
	move(crates, 4, 9, 6)
	move(crates, 6, 4, 9)
	move(crates, 2, 3, 4)
	move(crates, 6, 4, 7)
	move(crates, 6, 7, 5)
	move(crates, 10, 1, 5)
	move(crates, 4, 1, 2)
	move(crates, 4, 6, 3)
	move(crates, 6, 9, 7)
	move(crates, 2, 4, 9)
	move(crates, 7, 7, 6)
	move(crates, 1, 9, 7)
	move(crates, 2, 9, 8)
	move(crates, 2, 8, 2)
	move(crates, 1, 2, 5)
	move(crates, 3, 8, 4)
	move(crates, 4, 2, 7)
	move(crates, 3, 4, 7)
	move(crates, 2, 3, 5)
	move(crates, 2, 3, 2)
	move(crates, 18, 5, 3)
	move(crates, 6, 3, 1)
	move(crates, 8, 3, 1)
	move(crates, 8, 7, 9)
	move(crates, 9, 2, 5)
	move(crates, 3, 2, 3)
	move(crates, 7, 3, 7)
	move(crates, 3, 6, 4)
	move(crates, 1, 7, 1)
	move(crates, 7, 6, 7)
	move(crates, 1, 2, 9)
	move(crates, 1, 4, 2)
	move(crates, 13, 7, 2)
	move(crates, 10, 5, 3)
	move(crates, 1, 2, 9)
	move(crates, 7, 1, 5)
	move(crates, 8, 9, 5)
	move(crates, 1, 9, 5)
	move(crates, 1, 9, 8)
	move(crates, 1, 8, 2)
	move(crates, 8, 5, 3)
	move(crates, 18, 3, 5)
	move(crates, 2, 4, 1)
	move(crates, 3, 2, 5)
	move(crates, 27, 5, 1)
	move(crates, 17, 1, 5)
	move(crates, 2, 2, 3)
	move(crates, 1, 6, 5)
	move(crates, 2, 2, 5)
	move(crates, 1, 6, 4)
	move(crates, 1, 6, 9)
	move(crates, 2, 3, 5)
	move(crates, 17, 5, 6)
	move(crates, 1, 9, 3)
	move(crates, 6, 2, 4)
	move(crates, 1, 3, 2)
	move(crates, 3, 4, 9)
	move(crates, 1, 2, 9)
	move(crates, 1, 4, 7)
	move(crates, 3, 5, 2)
	move(crates, 2, 5, 1)
	move(crates, 1, 5, 2)
	move(crates, 1, 7, 3)
	move(crates, 18, 1, 4)
	move(crates, 1, 3, 1)
	move(crates, 5, 4, 2)
	move(crates, 1, 5, 1)
	move(crates, 9, 2, 7)
	move(crates, 1, 4, 5)
	move(crates, 1, 2, 9)
	move(crates, 8, 6, 2)
	move(crates, 13, 4, 2)
	move(crates, 2, 4, 9)
	move(crates, 1, 5, 2)
	move(crates, 1, 6, 8)
	move(crates, 6, 7, 5)
	move(crates, 1, 8, 4)
	move(crates, 1, 7, 6)
	move(crates, 1, 6, 1)
	move(crates, 7, 6, 5)
	move(crates, 1, 7, 9)
	move(crates, 6, 9, 3)
	move(crates, 2, 9, 7)
	move(crates, 2, 5, 7)
	move(crates, 4, 7, 8)
	move(crates, 4, 5, 4)
	move(crates, 1, 6, 7)
	move(crates, 3, 3, 8)
	move(crates, 6, 5, 9)
	move(crates, 2, 3, 5)
	move(crates, 4, 4, 7)
	move(crates, 1, 3, 1)
	move(crates, 2, 2, 3)
	move(crates, 6, 9, 6)
	move(crates, 1, 7, 1)
	move(crates, 19, 2, 4)
	move(crates, 2, 5, 6)
	move(crates, 2, 8, 9)
	move(crates, 2, 1, 2)
	move(crates, 2, 2, 5)
	move(crates, 2, 4, 3)
	move(crates, 4, 6, 2)
	move(crates, 1, 7, 8)
	move(crates, 6, 1, 8)
	move(crates, 3, 5, 1)
	move(crates, 5, 2, 5)
	move(crates, 1, 6, 7)
	move(crates, 9, 8, 1)
	move(crates, 2, 3, 6)
	move(crates, 4, 6, 5)
	move(crates, 1, 6, 2)
	move(crates, 9, 5, 2)
	move(crates, 3, 4, 6)
	move(crates, 12, 4, 6)
	move(crates, 1, 9, 4)
	move(crates, 1, 3, 1)
	move(crates, 3, 4, 8)
	move(crates, 1, 3, 6)
	move(crates, 6, 6, 2)
	move(crates, 1, 4, 5)
	move(crates, 3, 6, 2)
	move(crates, 4, 1, 5)
	move(crates, 1, 5, 1)
	move(crates, 2, 8, 9)
	move(crates, 7, 6, 3)
	move(crates, 1, 3, 1)
	move(crates, 1, 8, 1)
	move(crates, 3, 8, 9)
	move(crates, 4, 3, 5)
	move(crates, 3, 7, 3)
	move(crates, 5, 3, 7)
	move(crates, 1, 9, 1)
	move(crates, 4, 9, 2)
	move(crates, 15, 2, 7)
	move(crates, 14, 1, 7)
	move(crates, 5, 5, 1)
	move(crates, 9, 7, 2)
	move(crates, 1, 9, 6)
	move(crates, 1, 7, 4)
	move(crates, 1, 4, 6)
	move(crates, 2, 6, 2)
	move(crates, 9, 2, 5)
	move(crates, 4, 2, 4)
	move(crates, 4, 7, 5)
	move(crates, 6, 5, 9)
	move(crates, 7, 1, 8)
	move(crates, 6, 2, 8)
	move(crates, 1, 1, 2)
	move(crates, 3, 9, 5)
	move(crates, 18, 7, 8)
	move(crates, 2, 4, 6)
	move(crates, 2, 4, 6)
	move(crates, 3, 7, 6)
	move(crates, 3, 5, 3)
	move(crates, 1, 2, 6)
	move(crates, 5, 6, 8)
	move(crates, 29, 8, 1)
	move(crates, 2, 3, 5)
	move(crates, 25, 1, 6)
	move(crates, 2, 9, 5)
	move(crates, 1, 7, 8)
	move(crates, 6, 8, 2)
	move(crates, 1, 9, 1)
	move(crates, 15, 6, 8)
	move(crates, 1, 3, 8)
	move(crates, 14, 8, 7)
	move(crates, 5, 1, 3)
	move(crates, 1, 6, 2)
	move(crates, 2, 5, 7)
	move(crates, 10, 6, 2)
	move(crates, 4, 5, 7)
	move(crates, 6, 5, 1)
	move(crates, 2, 1, 4)
	move(crates, 19, 7, 9)

	output := make([]byte, len(crates)-1)
	for i := 1; i < len(crates); i++ {
		output[i-1] = crates[i][len(crates[i])-1]
	}
	return output
}

func move(c []crate, qty, from, to int) {
	split := len(c[from]) - qty

	top := c[from][split:]
	c[from] = c[from][:split]

	c[to] = append(c[to], top...)

	// for i := len(top) - 1; i >= 0; i-- {
	// 	c[to] = append(c[to], top[i])
	// }
}
